geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for the East and West",
subtitle="Percentage of average East to West GDP per Capita") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=35),
plot.subtitle = element_text(lineheight=.8, size=30),
axis.text=element_text(size=20),
axis.title=element_text(size=25,face="bold"),
axis.text.x = element_text(size = 14)) +
ggsave(paste(output_path, "over_time.png", sep=""))
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for the East and West",
subtitle="Percentage of average East to West GDP per Capita") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=35),
plot.subtitle = element_text(lineheight=.8, size=30),
axis.text=element_text(size=15),
axis.title=element_text(size=25,face="bold"),
axis.text.x = element_text(size = 14)) +
ggsave(paste(output_path, "over_time.png", sep=""))
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for the East and West",
subtitle="Percentage of average East to West GDP per Capita") +
labs(x="Year", y="Average GDP per Capita by Area")
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for the East and West",
subtitle="Percentage of average East to West GDP per Capita") +
labs(x="Year", y="Average GDP per Capita by Area") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=30),
plot.subtitle = element_text(lineheight=.8, size=30),
axis.text=element_text(size=15),
axis.title=element_text(size=20),
axis.text.x = element_text(size = 14)) +
ggsave(paste(output_path, "over_time.png", sep=""))
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for the East and West",
subtitle="Percentage of average East to West GDP per Capita") +
labs(x="Year", y="Average GDP per Capita by Area") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=30),
plot.subtitle = element_text(lineheight=.8, size=30),
axis.text=element_text(size=15),
axis.title=element_text(size=20),
axis.text.x = element_text(size = 14),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="bottom",) +
ggsave(paste(output_path, "over_time.png", sep=""))
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for East and West Germany",
subtitle="Percentage of average East to West GDP per Capita") +
labs(x="Year", y="Average GDP per Capita by Area") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=30),
plot.subtitle = element_text(lineheight=.8, size=20),
axis.text=element_text(size=15),
axis.title=element_text(size=20),
axis.text.x = element_text(size = 14),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="bottom",) +
ggsave(paste(output_path, "over_time.png", sep=""))
ggplot()  +
geom_bar(data=avg_gdp_data_wide, aes(x=year_num,
y=east_percent_west/100*scaler),
stat="identity", fill="tan1", colour="sienna3", alpha=0.1) +
geom_text(data=avg_gdp_data_wide, aes(label=east_percent_west, x=year_num,
y=east_percent_west/100*scaler),
colour="black") +
geom_line(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
geom_point(data=average_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area),
stat="identity") +
scale_y_continuous(sec.axis=sec_axis(trans=~./scaler*100,
name = "Percentage of the East to West Average GDP")) +
theme_tufte() +
ggtitle(label="Average GDP per Capita for East and West Germany",
subtitle="") +
labs(x="Year", y="Average GDP per Capita by Area") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=30),
plot.subtitle = element_text(lineheight=.8, size=20),
axis.text=element_text(size=15),
axis.title=element_text(size=20),
axis.text.x = element_text(size = 14),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="bottom",) +
ggsave(paste(output_path, "over_time.png", sep=""))
east_gdp_data = gdp_data %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland %in% !Bundesland)
east_gdp_data = gdp_data %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland !%in% Bundesland)
group_by(year_num, Area) %>%
summarize(avg_gdp = mean(real_gdp_per_capita)) %>%
ungroup()
east_gdp_data = gdp_data %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland == "East")
east_gdp_data = gdp_data %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland == "East") %>%
mutate(Area = if_else(Bundesland == "Berlin", "Berlin", "Rest")) %>%
group_by(year_num, Area) %>%
summarize(avg_gdp = mean(real_gdp_per_capita)) %>%
ungroup()
gdp_data
east_gdp_data = gdp_data %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland == "East") %>%
mutate(Area = if_else(Bundesland == "Berlin", "Berlin", "Rest")) %>%
group_by(year, Area) %>%
summarize(avg_gdp = mean(real_gdp_per_capita)) %>%
ungroup()
east_gdp_data
east_gdp_data = gdp_data %>%
mutate(year_num = as.numeric(as.character(year))) %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland == "East") %>%
mutate(Area = if_else(Bundesland == "Berlin", "Berlin", "Rest")) %>%
group_by(year_num, Area) %>%
summarize(avg_gdp = mean(real_gdp_per_capita)) %>%
ungroup()
east_gdp_data
gdp_data
east_gdp_data = gdp_data %>%
mutate(year_num = as.numeric(as.character(year))) %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West"))
east_gdp_data
east_gdp_data = gdp_data %>%
mutate(year_num = as.numeric(as.character(year))) %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Bundesland == "East") %>%
mutate(Area = if_else(Bundesland == "Berlin", "Berlin", "Rest"))
east_gdp_data
east_gdp_data = gdp_data %>%
mutate(year_num = as.numeric(as.character(year))) %>%
mutate(Area = if_else(Bundesland %in% east_states, "East", "West")) %>%
filter(Area == "East") %>%
mutate(Area = if_else(Bundesland == "Berlin", "Berlin", "Rest")) %>%
group_by(year_num, Area) %>%
summarize(avg_gdp = mean(real_gdp_per_capita)) %>%
ungroup()
east_gdp_data
ggplot()  +
geom_line(data=east_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area)) +
geom_point(data=east_gdp_data, aes(x=year_num, y=avg_gdp, group=Area,
color=Area)) +
theme_tufte() +
ggtitle(label="Average GDP per Capita of all",
subtitle="") +
labs(x="Year", y="Average GDP per Capita by Area") +
theme(plot.title = element_text(lineheight=.8, face="bold", size=30),
plot.subtitle = element_text(lineheight=.8, size=20),
axis.text=element_text(size=15),
axis.title=element_text(size=20),
axis.text.x = element_text(size = 14),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="bottom",) +
ggsave(paste(output_path, "berlin_influence.png", sep=""))
install.packages("magick")
library(magick)
setwd(paste(output_path, "/maps/")
# Converting .png files in one .gif image using ImageMagick
system("/opt/local/bin/convert -delay 80 *.png example_1.gif")
setwd(paste(output_path, "/maps/"))
paste(output_path, "/maps/")
setwd(paste(output_path, "/maps/", sep=""))
# Converting .png files in one .gif image using ImageMagick
system("/opt/local/bin/convert -delay 80 *.png example_1.gif")
# Converting .png files in one .gif image using ImageMagick
system("-delay 80 *.png example_1.gif")
# Converting .png files in one .gif image using ImageMagick
system("convert -delay 80 *.png example_1.gif")
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""),
width = 20, height = 10, dpi = 150, units = "cm", device='png')
unique(gdp_data$year)
gdp_per_year = gdp_data %>% filter(year==1991)
spatial_data_per_year = merge(spatial_list, gdp_per_year, by="id")
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""),
width = 20, height = 10, dpi = 150, units = "cm", device='png')
year_num=1991
gdp_per_year = gdp_data %>% filter(year==year_num)
spatial_data_per_year = merge(spatial_list, gdp_per_year, by="id")
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""),
width = 20, height = 10, dpi = 150, units = "cm", device='png')
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""),
width = 20, height = 10, dpi = 150, units = "in", device='png')
gdp_per_year = gdp_data %>% filter(year==year_num)
spatial_data_per_year = merge(spatial_list, gdp_per_year, by="id")
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""))
map_germany = getData(country="Germany", level=1)
from_list = c()
for (i in 1:(nrow(bip_per_state)-1)) {
id_num = map_germany@polygons[[i]]@ID
from_list = append(from_list, id_num)
}
to_list = seq(1:(nrow(bip_per_state)-1))
map = setNames(to_list, from_list)
spatial_list = broom::tidy(map_germany)
spatial_list$id = map[spatial_list$id]
overall_min = min(gdp_data$real_gdp_per_capita)
overall_max = max(gdp_data$real_gdp_per_capita)
for (year_num in unique(gdp_data$year)) {
gdp_per_year = gdp_data %>% filter(year==year_num)
spatial_data_per_year = merge(spatial_list, gdp_per_year, by="id")
gdp_plotting = spatial_data_per_year %>%
ggplot(aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
!Bundesland %in% c("Berlin", "Bremen"))) +
geom_polygon(aes(fill=real_gdp_per_capita), color="white",
data=filter(spatial_data_per_year,
Bundesland %in%  c("Berlin", "Bremen"))) +
theme_tufte() +
coord_fixed() +
scale_fill_gradient(name="Real Euros per Capita",
limits=c(overall_min, overall_max),
guide=guide_colourbar(barheight=unit(80, units="mm"),
barwidth=unit(5, units="mm"),
draw.ulim=F,
title.hjust=0.5,
label.hjust=0.5,
title.position="top")) +
coord_map() +
ggtitle(paste("GDP Per Capita -", year_num)) +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
legend.title=element_text(size=25),
legend.text=element_text(size=20),
legend.position="right",
plot.title = element_text(lineheight=.8, face="bold", size=45)) +
ggsave(paste(output_path, "/maps/", year_num, ".png", sep=""))
}
setwd(paste(output_path, "/maps/", sep=""))
system("convert -delay 80 *.png maps_over_time.gif")
file.remove(list.files(pattern=".png"))
for (year_num in unique(gdp_data$year)) {
real_gdp_data_year = gdp_data %>%
filter(year==year_num) %>%
filter(Bundesland != "Deutschland")
cum_real_gdp = Lc(real_gdp_data_year$real_gdp_per_capita)
gini_coef = round(Gini(real_gdp_data_year$real_gdp_per_capita), 2)
p = cum_real_gdp[1]
L = cum_real_gdp[2]
cum_fun_df = data.frame(p,L)
# plot
ggplot() +
geom_point(data=cum_fun_df, aes(x=p, y=L)) +
geom_line(data=cum_fun_df, aes(x=p, y=L), color="#990000") +
scale_y_continuous(name="Cumulative GDP per Capita", limits=c(0,1)) +
scale_x_continuous(name="Cumulative Number of States", limits=c(0,1)) +
geom_line(data=cum_fun_df, aes(x=p, y=p)) +
geom_ribbon(data=cum_fun_df, aes(x=p, ymin=L,ymax=p),
fill="blue", alpha=0.5) +
theme_tufte() +
ggtitle(label=paste("Lorenz Curve -", year_num),
subtitle=paste("Gini Coefficient: ", gini_coef)) +
theme(plot.title = element_text(lineheight=.8, face="bold", size=35),
plot.subtitle = element_text(lineheight=.8, size=30),
axis.text=element_text(size=20),
axis.title=element_text(size=25,face="bold"),
axis.text.x = element_text(size = 14)) +
ggsave(paste(output_path, "/gini/", year_num, ".png", sep=""))
}
setwd(paste(output_path, "/gini/", sep=""))
system("convert -delay 80 *.png gini_over_time.gif")
file.remove(list.files(pattern=".png"))
